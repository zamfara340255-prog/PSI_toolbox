# -*- coding: utf-8 -*-import tkinter as tkimport tkinter.ttk as ttkimport mathfrom core.utils import tb, MATPLOTLIB_OKfrom core.base_module import CalcModule# Импорт ScrolledFrametry:    from ttkbootstrap.scrolled import ScrolledFrameexcept ImportError:    class ScrolledFrame(tb.Frame):        def __init__(self, master, **kwargs):            super().__init__(master, **kwargs)class UnitConverterModule(CalcModule):    key = "units"    title = "Инструменты инженера"    def __init__(self, app):        super().__init__(app)                # --- ПЕРЕМЕННЫЕ КОНВЕРТЕРА ---        self.var_category = tk.StringVar(value="Расход топлива") # Дефолт        self.var_search = tk.StringVar()        self.var_value = tk.StringVar(value="10")        self.var_from = tk.StringVar()        self.var_current_source = tk.StringVar(value="")        self.var_precision = tk.StringVar(value="Авто")                # --- ПЕРЕМЕННЫЕ КАЛЬКУЛЯТОРОВ ---        self.ohm_u = tk.StringVar()        self.ohm_i = tk.StringVar()        self.ohm_r = tk.StringVar()        self.ohm_p = tk.StringVar()                self.reac_f = tk.StringVar()        self.reac_l = tk.StringVar()        self.reac_c = tk.StringVar()        self.reac_xl = tk.StringVar()        self.reac_xc = tk.StringVar()        self.par_r1 = tk.StringVar()        self.par_r2 = tk.StringVar()        self.par_rout = tk.StringVar()        self.div_vin = tk.StringVar()        self.div_r1 = tk.StringVar()        self.div_r2 = tk.StringVar()        self.div_vout = tk.StringVar()        # --- БАЗА ДАННЫХ ЕДИНИЦ ---        self.cats = {            "Расход топлива": [                # Спец. маркер "inv_l100" для л/100км, так как это обратная величина                ("Литров на 100 км (л/100км)", "inv_l100"),                 ("Километров на литр (км/л)", 1.0), # База                ("Миль на галлон США (MPG US)", 0.425144),                ("Миль на галлон UK (MPG UK)", 0.354006)            ],            "Скорость передачи данных": [                ("Бит в секунду (bps)", 1.0),                ("Килобит/с (Kbps)", 1e3), ("Мегабит/с (Mbps)", 1e6), ("Гигабит/с (Gbps)", 1e9),                ("Байт в секунду (B/s)", 8.0),                ("Килобайт/с (KB/s)", 8000.0), ("Мегабайт/с (MB/s)", 8e6), ("Гигабайт/с (GB/s)", 8e9)            ],            "Емкость аккумуляторов (Заряд)": [                ("Ампер-час (А·ч)", 1.0),                 ("Миллиампер-час (мА·ч)", 0.001),                 ("Кулон (Кл)", 1/3600.0), # А*с                ("Ампер-секунда", 1/3600.0),                ("Фарадей (химич)", 26.801)            ],            "Скорость перемещения": [                ("Метр в секунду (м/с)", 1.0),                 ("Километр в час (км/ч)", 0.277778),                 ("Миль в час (mph)", 0.44704),                 ("Узел (kn)", 0.514444),                 ("Мах (у земли)", 340.3),                ("Скорость света (c)", 299792458.0)            ],            "Сопротивление": [                ("Ом (Ω)", 1.0), ("Миллиом (мОм)", 0.001), ("Микроом (мкОм)", 1e-6),                ("Килоом (кОм)", 1e3), ("Мегаом (МОм)", 1e6), ("Гигаом (ГОм)", 1e9)            ],            "Емкость (Конденсаторы)": [                ("Фарад (Ф)", 1.0), ("Миллифарад (мФ)", 1e-3), ("Микрофарад (мкФ)", 1e-6),                 ("Нанофарад (нФ)", 1e-9), ("Пикофарад (пФ)", 1e-12), ("Фемтофарад (фФ)", 1e-15)            ],            "Индуктивность": [                ("Генри (Гн)", 1.0), ("Миллигенри (мГн)", 1e-3), ("Микрогенри (мкГн)", 1e-6),                 ("Наногенри (нГн)", 1e-9), ("Пикогенри (пГн)", 1e-12)            ],            "Мощность": [                ("Ватт (Вт)", 1.0), ("Киловатт (кВт)", 1000.0), ("Мегаватт (МВт)", 1e6),                 ("Милливатт (мВт)", 0.001), ("Микроватт (мкВт)", 1e-6),                ("Лошадиная сила", 735.5),                 ("дБм (dBm)", "dBm"), ("дБВт (dBW)", "dBW")            ],            "Напряжение": [                ("Вольт (В)", 1.0), ("мВ", 0.001), ("кВ", 1000.0), ("мкВ", 1e-6), ("дБмкВ (dBuV)", "dBuV")            ],            "Ток": [                ("Ампер (А)", 1.0), ("мА", 0.001), ("мкА", 1e-6), ("кА", 1000.0)            ],            "Частота": [                ("Герц (Гц)", 1.0), ("кГц", 1e3), ("МГц", 1e6), ("ГГц", 1e9)            ],            "Длина": [                ("Метр (м)", 1.0), ("Километр (км)", 1000.0), ("Сантиметр (см)", 0.01), ("Миллиметр (мм)", 0.001),                 ("Микрометр (мкм)", 1e-6), ("Нанометр (нм)", 1e-9), ("Ангстрем (Å)", 1e-10),                ("Миля", 1609.34), ("Морская миля", 1852.0),                ("Ярд", 0.9144), ("Фут", 0.3048), ("Дюйм", 0.0254)            ],            "Масса": [                ("Килограмм (кг)", 1.0), ("Грамм (г)", 0.001), ("Тонна (т)", 1000.0),                 ("Фунт (lb)", 0.453592), ("Унция (oz)", 0.0283495)            ],            "Время": [                ("Секунда (с)", 1.0), ("Миллисекунда (мс)", 0.001), ("Микросекунда (мкс)", 1e-6), ("Наносекунда (нс)", 1e-9),                 ("Минута", 60.0), ("Час", 3600.0), ("Сутки", 86400.0), ("Год", 31557600.0)            ],            "Площадь": [                ("м²", 1.0), ("см²", 0.0001), ("Гектар (га)", 10000.0), ("Сотка", 100.0), ("Акр", 4046.86)            ],            "Объем": [                ("м³", 1.0), ("Литр (л)", 0.001), ("мл", 1e-6),                 ("Галлон (US)", 0.00378541), ("Баррель", 0.158987)            ],            "Температура": [                 ("Цельсий (°C)", "C"), ("Фаренгейт (°F)", "F"), ("Кельвин (K)", "K")            ],            "Давление": [                ("Паскаль (Па)", 1.0), ("бар", 100000.0), ("атм", 101325.0),                 ("мм рт.ст.", 133.322), ("psi", 6894.76)            ],            "Энергия": [                ("Джоуль (Дж)", 1.0), ("кДж", 1000.0), ("Калория", 4.184), ("кВт⋅ч", 3.6e6), ("эВ", 1.60218e-19)            ],            "Сила": [                ("Ньютон (Н)", 1.0), ("кгс", 9.80665), ("lbf", 4.44822)            ],            "Информация (Размер)": [                ("Бит", 0.125), ("Байт", 1.0), ("КБ", 1024), ("МБ", 1024**2), ("ГБ", 1024**3), ("ТБ", 1024**4)            ],            "Углы": [                ("Градус", 1.0), ("Радиан", 57.2958), ("Оборот", 360.0)            ]        }    def toolbar_actions(self):        return []    def build_ui(self, parent):        self.frame = tb.Frame(parent)        self.notebook = ttk.Notebook(self.frame, bootstyle="primary")        self.notebook.pack(fill="both", expand=True, padx=10, pady=10)        self.tab_conv = tb.Frame(self.notebook)        self.notebook.add(self.tab_conv, text="  Конвертер единиц  ")        self.build_converter_ui(self.tab_conv)        self.tab_calc = tb.Frame(self.notebook)        self.notebook.add(self.tab_calc, text="  Инженерные калькуляторы  ")        self.build_calculator_ui(self.tab_calc)        return self.frame    # ==========================================    #      ВКЛАДКА 1: КОНВЕРТЕР    # ==========================================    def build_converter_ui(self, parent):        pad = 20        main_box = tb.Frame(parent)        main_box.pack(fill="both", expand=True, padx=pad, pady=pad)        # --- ЛЕВАЯ КОЛОНКА ---        left_panel = tb.Labelframe(main_box, text="Входные данные", padding=pad)        left_panel.pack(side="left", fill="y", padx=(0, 20))        tb.Label(left_panel, text="Поиск категории:", font=("Segoe UI", 9)).pack(anchor="w", pady=(0, 2))        search_entry = tb.Entry(left_panel, textvariable=self.var_search, font=("Segoe UI", 9))        search_entry.pack(fill="x", pady=(0, 10))        search_entry.bind("<KeyRelease>", self.filter_categories)        tb.Label(left_panel, text="Категория:", font=("Segoe UI", 9)).pack(anchor="w", pady=(0, 2))        self.cb_cat = tb.Combobox(left_panel, textvariable=self.var_category,                              values=sorted(list(self.cats.keys())), state="readonly", font=("Segoe UI", 9), width=22)        self.cb_cat.pack(fill="x", pady=(0, 10))        self.cb_cat.bind("<<ComboboxSelected>>", self.update_units_list)        tb.Label(left_panel, text="Значение:", font=("Segoe UI", 9)).pack(anchor="w", pady=(0, 2))        entry_val = tb.Entry(left_panel, textvariable=self.var_value, font=("Segoe UI", 10))        entry_val.pack(fill="x", pady=(0, 10))        entry_val.bind("<KeyRelease>", lambda e: self.calculate())        tb.Label(left_panel, text="Исходная единица:", font=("Segoe UI", 9)).pack(anchor="w", pady=(0, 2))        self.cb_from = tb.Combobox(left_panel, textvariable=self.var_from, state="readonly", font=("Segoe UI", 9))        self.cb_from.pack(fill="x", pady=(0, 10))        self.cb_from.bind("<<ComboboxSelected>>", lambda e: self.calculate())        # Округление        tb.Label(left_panel, text="Округление (знаков):", font=("Segoe UI", 9)).pack(anchor="w", pady=(0, 2))        prec_values = ["Авто", "0", "1", "2", "3", "4", "5", "6", "8", "10"]        cb_prec = tb.Combobox(left_panel, textvariable=self.var_precision, values=prec_values, state="readonly", font=("Segoe UI", 9))        cb_prec.pack(fill="x", pady=(0, 15))        cb_prec.bind("<<ComboboxSelected>>", lambda e: self.calculate())        tb.Button(left_panel, text="ПЕРЕСЧИТАТЬ", command=self.calculate, bootstyle="primary", width=15).pack(fill="x", pady=10)        # Плашка с исходной единицей        source_frame = tb.Frame(left_panel, bootstyle="primary", padding=10)        source_frame.pack(fill="x", pady=(20, 0))        tb.Label(source_frame, text="КОНВЕРТИРУЕМ:", font=("Segoe UI", 8), bootstyle="inverse-primary").pack(anchor="w")        tb.Label(source_frame, textvariable=self.var_current_source, font=("Segoe UI", 14, "bold"), bootstyle="inverse-primary", wraplength=180).pack(anchor="w")        # --- ПРАВАЯ КОЛОНКА ---        right_panel = tb.Labelframe(main_box, text="Результаты конвертации", padding=pad)        right_panel.pack(side="right", fill="both", expand=True)        style = ttk.Style()        style.configure("Big.Treeview", font=('Segoe UI', 13), rowheight=35)         style.configure("Big.Treeview.Heading", font=('Segoe UI', 11, 'bold'))        columns = ("unit", "value")        self.tree = ttk.Treeview(right_panel, columns=columns, show="headings", style="Big.Treeview")        self.tree.heading("unit", text="Единица измерения", anchor="w")        self.tree.heading("value", text="Значение", anchor="e")        self.tree.column("unit", width=250, minwidth=150, anchor="w")        self.tree.column("value", width=250, minwidth=150, anchor="e")         self.tree.tag_configure('odd', background='#f7f7f7')              self.tree.tag_configure('even', background='#ffffff')             scrollbar = tb.Scrollbar(right_panel, orient="vertical", command=self.tree.yview)        self.tree.configure(yscrollcommand=scrollbar.set)        scrollbar.pack(side="right", fill="y")        self.tree.pack(side="left", fill="both", expand=True)        self.update_units_list()    # ==========================================    #      ВКЛАДКА 2: КАЛЬКУЛЯТОРЫ    # ==========================================    def build_calculator_ui(self, parent):        scroll = ScrolledFrame(parent)        scroll.pack(fill="both", expand=True)        container = tb.Frame(scroll)        container.pack(fill="x", expand=True, padx=30, pady=20)        # 1. ЗАКОН ОМА        ohm_fr = tb.Labelframe(container, text="1. Закон Ома (U, I, R, P)", padding=15, bootstyle="info")        ohm_fr.pack(fill="x", pady=(0, 20))        tb.Label(ohm_fr, text="Введите любые 2 значения:", font=("Segoe UI", 9), bootstyle="secondary").pack(anchor="w", pady=(0, 10))        g1 = tb.Frame(ohm_fr); g1.pack(fill="x")        self.create_calc_entry(g1, "Напряжение (U), В", self.ohm_u)        self.create_calc_entry(g1, "Сила тока (I), А", self.ohm_i)        self.create_calc_entry(g1, "Сопротивление (R), Ом", self.ohm_r)        self.create_calc_entry(g1, "Мощность (P), Вт", self.ohm_p)        b1 = tb.Frame(ohm_fr); b1.pack(fill="x", pady=(10, 0))        tb.Button(b1, text="Рассчитать", command=self.calc_ohm, bootstyle="info").pack(side="left", padx=5)        tb.Button(b1, text="Очистить", command=self.clear_ohm, bootstyle="secondary-outline").pack(side="left", padx=5)        # 2. ПАРАЛЛЕЛЬНЫЕ РЕЗИСТОРЫ        par_fr = tb.Labelframe(container, text="2. Параллельное соединение резисторов", padding=15, bootstyle="success")        par_fr.pack(fill="x", pady=(0, 20))        g2 = tb.Frame(par_fr); g2.pack(fill="x")        self.create_calc_entry(g2, "R1, Ом", self.par_r1)        self.create_calc_entry(g2, "R2, Ом", self.par_r2)        fr_out = tb.Frame(g2); fr_out.pack(side="left", fill="x", expand=True, padx=5)        tb.Label(fr_out, text="R общее:", font=("Segoe UI", 10, "bold")).pack(anchor="w")        tb.Entry(fr_out, textvariable=self.par_rout, state="readonly", bootstyle="success", font=("Segoe UI", 11)).pack(fill="x")        b2 = tb.Frame(par_fr); b2.pack(fill="x", pady=(10, 0))        tb.Button(b2, text="Рассчитать R общ", command=self.calc_parallel, bootstyle="success").pack(side="left", padx=5)        tb.Button(b2, text="Очистить", command=lambda: [self.par_r1.set(""), self.par_r2.set(""), self.par_rout.set("")], bootstyle="secondary-outline").pack(side="left", padx=5)        # 3. ДЕЛИТЕЛЬ НАПРЯЖЕНИЯ        div_fr = tb.Labelframe(container, text="3. Делитель напряжения", padding=15, bootstyle="primary")        div_fr.pack(fill="x", pady=(0, 20))        g3 = tb.Frame(div_fr); g3.pack(fill="x")        self.create_calc_entry(g3, "V вход, В", self.div_vin)        self.create_calc_entry(g3, "R1 (верх), Ом", self.div_r1)        self.create_calc_entry(g3, "R2 (низ), Ом", self.div_r2)        fr_vout = tb.Frame(g3); fr_vout.pack(side="left", fill="x", expand=True, padx=5)        tb.Label(fr_vout, text="V выход:", font=("Segoe UI", 10, "bold")).pack(anchor="w")        tb.Entry(fr_vout, textvariable=self.div_vout, state="readonly", bootstyle="primary", font=("Segoe UI", 11)).pack(fill="x")        b3 = tb.Frame(div_fr); b3.pack(fill="x", pady=(10, 0))        tb.Button(b3, text="Рассчитать Vout", command=self.calc_divider, bootstyle="primary").pack(side="left", padx=5)        tb.Button(b3, text="Очистить", command=lambda: [self.div_vin.set(""), self.div_r1.set(""), self.div_r2.set(""), self.div_vout.set("")], bootstyle="secondary-outline").pack(side="left", padx=5)        # 4. РЕАКТИВНОЕ СОПРОТИВЛЕНИЕ        reac_fr = tb.Labelframe(container, text="4. Реактивное сопротивление (LC)", padding=15, bootstyle="warning")        reac_fr.pack(fill="x", pady=(0, 50))        tb.Label(reac_fr, text="Введите Частоту и (L или C):", font=("Segoe UI", 9), bootstyle="secondary").pack(anchor="w", pady=(0, 10))        g4 = tb.Frame(reac_fr); g4.pack(fill="x")        self.create_calc_entry(g4, "Частота (f), Гц", self.reac_f)        self.create_calc_entry(g4, "Индуктивность (L), Гн", self.reac_l)        self.create_calc_entry(g4, "Емкость (C), Ф", self.reac_c)        out_lc = tb.Frame(reac_fr, padding=(0, 10)); out_lc.pack(fill="x")        xl_box = tb.Frame(out_lc); xl_box.pack(side="left", fill="x", expand=True, padx=5)        tb.Label(xl_box, text="X_L (Ом):").pack(anchor="w")        tb.Entry(xl_box, textvariable=self.reac_xl, state="readonly", bootstyle="warning").pack(fill="x")        xc_box = tb.Frame(out_lc); xc_box.pack(side="left", fill="x", expand=True, padx=5)        tb.Label(xc_box, text="X_C (Ом):").pack(anchor="w")        tb.Entry(xc_box, textvariable=self.reac_xc, state="readonly", bootstyle="warning").pack(fill="x")        b4 = tb.Frame(reac_fr); b4.pack(fill="x")        tb.Button(b4, text="Рассчитать LC", command=self.calc_reactance, bootstyle="warning").pack(side="left", padx=5)        tb.Button(b4, text="Очистить", command=self.clear_reactance, bootstyle="secondary-outline").pack(side="left", padx=5)    def create_calc_entry(self, parent, label, var):        fr = tb.Frame(parent)        fr.pack(side="left", fill="x", expand=True, padx=5)        tb.Label(fr, text=label, font=("Segoe UI", 10, "bold")).pack(anchor="w")        tb.Entry(fr, textvariable=var, font=("Segoe UI", 11)).pack(fill="x")    # --- ЛОГИКА КАЛЬКУЛЯТОРОВ ---    def _get(self, var):        try: return float(var.get().replace(",", "."))        except: return None    def _set(self, var, val):        if val is None: var.set("")        elif val > 1e4 or val < 1e-4: var.set(f"{val:.4e}")        else: var.set(f"{val:.6f}".rstrip('0').rstrip('.'))    def clear_ohm(self):        for v in [self.ohm_u, self.ohm_i, self.ohm_r, self.ohm_p]: v.set("")    def calc_ohm(self):        u, i = self._get(self.ohm_u), self._get(self.ohm_i)        r, p = self._get(self.ohm_r), self._get(self.ohm_p)        try:            if u is not None and i is not None: r = u/i if i!=0 else 0; p = u*i            elif u is not None and r is not None: i = u/r if r!=0 else 0; p = (u**2)/r if r!=0 else 0            elif i is not None and r is not None: u = i*r; p = (i**2)*r            elif p is not None and r is not None: u = math.sqrt(p*r); i = math.sqrt(p/r) if r!=0 else 0            elif p is not None and u is not None: i = p/u if u!=0 else 0; r = (u**2)/p if p!=0 else 0            elif p is not None and i is not None: u = p/i if i!=0 else 0; r = p/(i**2) if i!=0 else 0                        self._set(self.ohm_u, u); self._set(self.ohm_i, i)            self._set(self.ohm_r, r); self._set(self.ohm_p, p)        except: pass    def calc_parallel(self):        r1, r2 = self._get(self.par_r1), self._get(self.par_r2)        if r1 is not None and r2 is not None:            if (r1 + r2) != 0: self._set(self.par_rout, (r1 * r2) / (r1 + r2))    def calc_divider(self):        vin = self._get(self.div_vin)        r1, r2 = self._get(self.div_r1), self._get(self.div_r2)        if vin is not None and r1 is not None and r2 is not None:            if (r1 + r2) != 0: self._set(self.div_vout, vin * (r2 / (r1 + r2)))    def clear_reactance(self):        for v in [self.reac_f, self.reac_l, self.reac_c, self.reac_xl, self.reac_xc]: v.set("")    def calc_reactance(self):        f = self._get(self.reac_f)        l = self._get(self.reac_l)        c = self._get(self.reac_c)        if f is None or f <= 0: return        if l is not None: self._set(self.reac_xl, 2 * math.pi * f * l)        else: self.reac_xl.set("")        if c is not None and c > 0: self._set(self.reac_xc, 1 / (2 * math.pi * f * c))        else: self.reac_xc.set("")    # --- ЛОГИКА КОНВЕРТЕРА ---    def filter_categories(self, event):        search_text = self.var_search.get().lower()        all_cats = sorted(list(self.cats.keys()))        if not search_text: self.cb_cat['values'] = all_cats        else:            filtered = [c for c in all_cats if search_text in c.lower()]            self.cb_cat['values'] = filtered            if filtered: self.cb_cat.current(0); self.update_units_list()    def update_units_list(self, event=None):        cat = self.var_category.get()        if cat in self.cats:            units = [u[0] for u in self.cats[cat]]            self.cb_from['values'] = units            if self.var_from.get() not in units and units: self.var_from.set(units[0])            elif not self.var_from.get() and units: self.var_from.set(units[0])            self.calculate()    def _get_factor(self, cat, unit_name):        for u, f in self.cats[cat]:            if u == unit_name: return f        return 1.0    def calculate(self):        for item in self.tree.get_children(): self.tree.delete(item)        try:            val_str = self.var_value.get().replace(",", ".")            if not val_str: self.var_current_source.set("---"); return            val = float(val_str)            cat = self.var_category.get()            u_from = self.var_from.get()            self.var_current_source.set(f"{val} {u_from}")            fact_from = self._get_factor(cat, u_from)            base_val = 0.0            if cat == "Температура":                if "°C" in u_from: base_val = val                elif "°F" in u_from: base_val = (val - 32) * 5/9                elif "K" in u_from: base_val = val - 273.15            elif cat == "Мощность" and type(fact_from) == str:                 if "dBm" in u_from: base_val = 10 ** ((val - 30) / 10)                elif "dBW" in u_from: base_val = 10 ** (val / 10)            elif cat == "Напряжение" and type(fact_from) == str:                  if "dBuV" in u_from: base_val = 10 ** ((val - 120) / 20)            elif cat == "Расход топлива" and fact_from == "inv_l100": # L/100km -> km/L                 if val > 0: base_val = 100 / val                 else: base_val = 0            else:                if isinstance(fact_from, (int, float)): base_val = val * fact_from                else: base_val = val             row_idx = 0            prec_mode = self.var_precision.get()            for u_name, u_fact in self.cats[cat]:                if u_name == u_from: continue                 res, is_error = 0.0, False                                if cat == "Температура":                    if "°C" in u_name: res = base_val                    elif "°F" in u_name: res = base_val * 9/5 + 32                    elif "K" in u_name: res = base_val + 273.15                elif cat == "Мощность" and type(u_fact) == str:                    if base_val <= 0: is_error = True; res_str = "-∞"                    else:                        if "dBm" in u_name: res = 10 * math.log10(base_val) + 30                        elif "dBW" in u_name: res = 10 * math.log10(base_val)                elif cat == "Напряжение" and type(u_fact) == str:                    if base_val <= 0: is_error = True; res_str = "-∞"                    else:                        if "dBuV" in u_name: res = 20 * math.log10(base_val) + 120                elif cat == "Расход топлива" and u_fact == "inv_l100":                    if base_val > 0: res = 100 / base_val                    else: res = 0                else:                    if isinstance(u_fact, (int, float)): res = base_val / u_fact                    else: res = 0                 if not is_error:                    if prec_mode == "Авто":                        if abs(res) < 1e-6 or abs(res) >= 1e9: res_str = f"{res:.6e}"                        else: res_str = f"{res:.8f}".rstrip('0').rstrip('.')                    else:                        try:                            p = int(prec_mode)                            res_str = f"{res:.{p}f}"                        except: res_str = str(res)                    if res_str == "" or res_str == ".": res_str = "0"                tag = 'even' if row_idx % 2 == 0 else 'odd'                self.tree.insert("", "end", values=(u_name, res_str), tags=(tag,))                row_idx += 1        except ValueError: self.var_current_source.set("Ошибка")        except Exception as e: print(f"Calc error: {e}")